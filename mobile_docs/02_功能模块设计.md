# 律时移动端 - 功能模块设计

> **版本**: 3.0  
> **更新日期**: 2026-01-01  
> **设计原则**: 完整功能覆盖，移动端与桌面端功能对等

---

## 一、移动端定位

### 1.1 核心理念

> **"移动端是完整的工作客户端，支持所有核心业务操作"**

移动端不是 Web 端的"简化版"，而是具备完整功能的独立客户端。律师可以随时随地完成任何工作，无需切换到电脑。

### 1.2 功能覆盖原则

| 原则 | 说明 |
|------|------|
| **功能对等** | 移动端实现所有 Web 端核心功能 |
| **交互适配** | 针对触屏操作优化交互方式 |
| **体验一致** | 数据和操作在多端无缝衔接 |

---

## 二、完整功能清单

### 模块优先级

```
P0 核心必须 ─────────────────────────────────────────
│ 登录认证 │ 计时记录 │ 案件管理 │ 任务看板 │ 团队沟通 │
────────────────────────────────────────────────────

P1 重要功能 ─────────────────────────────────────────
│ 文档中心 │ 日程管理 │ 通知中心 │ 审批流程 │
────────────────────────────────────────────────────

P2 完善功能 ─────────────────────────────────────────
│ 个人仪表盘 │ 全局搜索 │ AI助手 │ 系统设置 │
────────────────────────────────────────────────────
```

---

## 三、P0 模块详细设计

### 3.1 登录认证

| 功能 | 描述 |
|------|------|
| 邮箱密码登录 | 标准认证 |
| 生物识别 | 指纹/面容快速解锁 |
| 自动登录 | Token 持久化 |
| 密码重置 | 邮件验证流程 |

---

### 3.2 计时记录 ⭐

#### 完整功能

| 功能 | 描述 | 操作权限 |
|------|------|----------|
| 快速计时 | 一键开始/暂停/停止 | ✅ |
| **详细工时编辑** | 修改时长、描述、案件关联 | ✅ 完整编辑 |
| 语音描述 | 语音转文字录入 | ✅ |
| 工时列表 | 按日期分组展示 | ✅ |
| 批量操作 | 多选删除/提交审批 | ✅ |
| 工时汇总 | 日/周/月统计图表 | ✅ |
| 离线记录 | 断网可用，恢复后同步 | ✅ |

#### 详细编辑界面

```
┌─────────────────────────────────────┐
│ ← 编辑工时                          │
├─────────────────────────────────────┤
│                                     │
│  关联案件                            │
│  ┌─────────────────────────────────┐│
│  │ 📁 张三诉李四合同纠纷案    ▼   ││
│  └─────────────────────────────────┘│
│                                     │
│  工作日期                            │
│  ┌─────────────────────────────────┐│
│  │ 📅 2026-01-01              ▼   ││
│  └─────────────────────────────────┘│
│                                     │
│  开始时间          结束时间          │
│  ┌──────────┐     ┌──────────┐     │
│  │ 09:00    │     │ 11:30    │     │
│  └──────────┘     └──────────┘     │
│                                     │
│  时长: 2小时 30分钟                  │
│                                     │
│  工作内容                            │
│  ┌─────────────────────────────────┐│
│  │ 起草合同初稿，与客户电话沟通    ││
│  │ 确认合同条款...                 ││
│  │                            🎤   ││
│  └─────────────────────────────────┘│
│                                     │
│  计费类型                            │
│  ○ 按小时计费  ● 固定费用  ○ 不计费  │
│                                     │
│  ┌─────────────────────────────────┐│
│  │           保存修改               ││
│  └─────────────────────────────────┘│
└─────────────────────────────────────┘
```

---

### 3.3 案件管理 ⭐

#### 完整功能

| 功能 | 描述 | 操作权限 |
|------|------|----------|
| 案件列表 | 搜索、筛选、排序 | ✅ |
| **新建案件向导** | 分步表单创建案件 | ✅ 完整向导 |
| **案件详细编辑** | 修改案件所有信息 | ✅ 完整编辑 |
| 状态变更 | 工作流状态切换 | ✅ |
| 团队管理 | 添加/移除团队成员 | ✅ |
| 利益冲突审查 | 冲突检测流程 | ✅ |

#### 新建案件向导

```
┌─────────────────────────────────────┐
│ 新建案件                      1/5   │
│ ━━━━━━━━░░░░░░░░░░░░░░░░░░░░░░░░░░ │
├─────────────────────────────────────┤
│                                     │
│  步骤 1: 基本信息                    │
│                                     │
│  案件名称 *                          │
│  ┌─────────────────────────────────┐│
│  │ 例：张三诉李四合同纠纷案         ││
│  └─────────────────────────────────┘│
│                                     │
│  案件类型 *                          │
│  ┌─────────────────────────────────┐│
│  │ 民事 / 合同纠纷              ▼  ││
│  └─────────────────────────────────┘│
│                                     │
│  业务领域                            │
│  ┌─────────────────────────────────┐│
│  │ 商事诉讼                     ▼  ││
│  └─────────────────────────────────┘│
│                                     │
│  争议金额                            │
│  ┌─────────────────────────────────┐│
│  │ ¥ 500,000                       ││
│  └─────────────────────────────────┘│
│                                     │
├─────────────────────────────────────┤
│  [上一步]              [下一步 →]   │
└─────────────────────────────────────┘

向导步骤：
1. 基本信息（名称、类型、金额）
2. 当事人信息（委托人、对方当事人）
3. 团队配置（承办律师、协办律师）
4. 利益冲突审查
5. 确认并创建
```

#### 案件详细编辑

```
┌─────────────────────────────────────┐
│ ← 编辑案件                          │
├─────────────────────────────────────┤
│ [基本信息][当事人][团队][收费][更多] │
├─────────────────────────────────────┤
│                                     │
│  案件名称                            │
│  ┌─────────────────────────────────┐│
│  │ 张三诉李四合同纠纷案             ││
│  └─────────────────────────────────┘│
│                                     │
│  案件状态                            │
│  ┌─────────────────────────────────┐│
│  │ 🟢 进行中                    ▼  ││
│  └─────────────────────────────────┘│
│                                     │
│  案件描述                            │
│  ┌─────────────────────────────────┐│
│  │ 原告因被告违反合同约定，未按    ││
│  │ 时支付货款，诉请法院判令...     ││
│  │                                 ││
│  └─────────────────────────────────┘│
│                                     │
│  ... (更多字段)                      │
│                                     │
├─────────────────────────────────────┤
│  ┌─────────────────────────────────┐│
│  │           保存修改               ││
│  └─────────────────────────────────┘│
└─────────────────────────────────────┘
```

---

### 3.4 任务看板 ⭐

#### 完整功能

| 功能 | 描述 | 操作权限 |
|------|------|----------|
| 看板视图 | Kanban 多列展示 | ✅ |
| **看板拖拽** | 跨列拖拽任务 | ✅ 完整拖拽 |
| **高级编辑** | 创建/编辑完整任务 | ✅ |
| 任务分配 | 指派团队成员 | ✅ |
| 子任务 | 创建/管理子任务 | ✅ |
| 标签管理 | 添加/编辑标签 | ✅ |
| 列表视图 | 传统列表展示 | ✅ |
| 筛选排序 | 多条件筛选 | ✅ |

#### 看板拖拽交互

```
水平滚动看板
┌────────────────────────────────────────────────────┐
│  待办 (3)      │  进行中 (2)    │  已完成 (5)    │
├────────────────┼────────────────┼────────────────┤
│ ┌────────────┐ │ ┌────────────┐ │ ┌────────────┐ │
│ │准备开庭材料│ │ │起草答辩状  │ │ │合同审查    │ │
│ │🔴 高 📅明天│ │ │🟡 中       │ │ │☑️ 已完成   │ │
│ └────────────┘ │ └────────────┘ │ └────────────┘ │
│       ↑        │                │                │
│  长按拖动       │                │                │
│       ↓        │                │                │
│ ┌────────────┐ │ ┌────────────┐ │ ┌────────────┐ │
│ │整理证据清单│ │ │客户沟通    │ │ │...         │ │
│ │🟢 低       │ │ │🟢 低       │ │ │            │ │
│ └────────────┘ │ └────────────┘ │ └────────────┘ │
│                │                │                │
│  ➕ 添加任务   │  ➕ 添加任务   │                │
└────────────────┴────────────────┴────────────────┘

操作方式：
- 长按卡片 → 进入拖动模式
- 拖动至目标列 → 松开完成状态变更
- 列内拖动 → 调整优先级排序
```

#### 任务完整编辑

```
┌─────────────────────────────────────┐
│ ← 编辑任务                          │
├─────────────────────────────────────┤
│                                     │
│  任务标题 *                          │
│  ┌─────────────────────────────────┐│
│  │ 准备开庭材料                     ││
│  └─────────────────────────────────┘│
│                                     │
│  描述                                │
│  ┌─────────────────────────────────┐│
│  │ 整理证据清单、准备质证意见、    ││
│  │ 打印开庭所需文件副本...         ││
│  └─────────────────────────────────┘│
│                                     │
│  关联案件                            │
│  ┌─────────────────────────────────┐│
│  │ 📁 张三诉李四案              ▼  ││
│  └─────────────────────────────────┘│
│                                     │
│  负责人                              │
│  ┌─────────────────────────────────┐│
│  │ 👤 王律师                    ▼  ││
│  └─────────────────────────────────┘│
│                                     │
│  截止日期          优先级            │
│  ┌──────────┐     ┌──────────┐     │
│  │ 📅 明天  │     │ 🔴 高    │     │
│  └──────────┘     └──────────┘     │
│                                     │
│  标签                                │
│  [紧急] [开庭相关] [+ 添加标签]     │
│                                     │
│  ─────────────────────────────────  │
│  子任务                              │
│  ☑️ 整理证据清单                     │
│  ☐ 准备质证意见                      │
│  ☐ 打印文件                          │
│  ➕ 添加子任务                       │
│                                     │
├─────────────────────────────────────┤
│  ┌─────────────────────────────────┐│
│  │           保存修改               ││
│  └─────────────────────────────────┘│
└─────────────────────────────────────┘
```

---

### 3.5 团队沟通 ⭐

| 功能 | 描述 |
|------|------|
| 案件群聊 | 按案件分组 |
| 私聊 | 一对一沟通 |
| 消息类型 | 文字/图片/文件/语音 |
| @ 提及 | @成员通知 |
| 消息搜索 | 历史消息搜索 |
| 实时推送 | FCM 推送 |

---

## 四、P1 模块详细设计

### 4.1 文档中心 ⭐

#### 完整功能

| 功能 | 描述 | 操作权限 |
|------|------|----------|
| 文档列表 | 按案件/标签浏览 | ✅ |
| 文档预览 | PDF/图片/Office | ✅ |
| **文档上传** | 拍照/相册/文件 | ✅ |
| **文档编辑** | 基础编辑功能 | ✅ |
| **批注标记** | 添加批注/高亮 | ✅ |
| 版本管理 | 查看历史版本 | ✅ |
| 离线缓存 | 标记离线可用 | ✅ |

#### 文档批注界面

```
┌─────────────────────────────────────┐
│ ← 合同草稿.pdf          [📤][✏️][⋮]│
├─────────────────────────────────────┤
│  ┌─────────────────────────────────┐│
│  │                                 ││
│  │      [文档预览区域]             ││
│  │                                 ││
│  │   ┌──────────────────┐          ││
│  │   │ 第三条 付款方式  │←─ 高亮   ││
│  │   └──────────────────┘          ││
│  │         💬 ←─ 批注气泡          ││
│  │                                 ││
│  └─────────────────────────────────┘│
├─────────────────────────────────────┤
│ 批注工具栏                           │
│ [🖍️高亮] [💬评论] [✏️画笔] [📌标记] │
├─────────────────────────────────────┤
│ 批注列表 (3)                         │
│ ├ 第3页: "付款条款需要修改"         │
│ ├ 第5页: "违约金比例过高"           │
│ └ 第8页: "签字盖章位置"              │
└─────────────────────────────────────┘
```

---

### 4.2 日程管理 ⭐

#### 完整功能

| 功能 | 描述 | 操作权限 |
|------|------|----------|
| 日/周/月视图 | 多种视图切换 | ✅ |
| **创建日程** | 完整日程表单 | ✅ |
| **编辑日程** | 修改所有信息 | ✅ |
| **批量安排** | 批量创建/修改 | ✅ |
| 拖拽调整 | 拖动调整时间 | ✅ |
| 日程提醒 | 本地+推送通知 | ✅ |
| 参与人管理 | 邀请团队成员 | ✅ |

#### 日程批量安排

```
┌─────────────────────────────────────┐
│ ← 批量安排日程                      │
├─────────────────────────────────────┤
│                                     │
│  日程标题                            │
│  ┌─────────────────────────────────┐│
│  │ 案件例会                         ││
│  └─────────────────────────────────┘│
│                                     │
│  重复模式                            │
│  ┌─────────────────────────────────┐│
│  │ 每周重复                     ▼  ││
│  └─────────────────────────────────┘│
│                                     │
│  重复日期                            │
│  [周一] [周三] [周五]                │
│                                     │
│  时间                                │
│  ┌──────────┐  至  ┌──────────┐    │
│  │ 10:00    │      │ 11:00    │    │
│  └──────────┘      └──────────┘    │
│                                     │
│  日期范围                            │
│  ┌──────────┐  至  ┌──────────┐    │
│  │ 01-01    │      │ 03-31    │    │
│  └──────────┘      └──────────┘    │
│                                     │
│  将创建 26 个日程                    │
│                                     │
├─────────────────────────────────────┤
│  ┌─────────────────────────────────┐│
│  │          批量创建                ││
│  └─────────────────────────────────┘│
└─────────────────────────────────────┘
```

#### 周视图（拖拽调整）

```
┌─────────────────────────────────────┐
│ ◀ 2026年1月第1周 ▶                  │
├─────────────────────────────────────┤
│      一    二    三    四    五     │
├──────┬─────┬─────┬─────┬─────┬──────┤
│ 9:00 │     │     │     │     │      │
│──────│─────│─────│─────│─────│──────│
│10:00 │▓▓▓▓▓│     │▓▓▓▓▓│     │▓▓▓▓▓│
│      │案件 │     │案件 │     │案件  │
│      │例会 │     │例会 │     │例会  │
│──────│─────│─────│─────│─────│──────│
│11:00 │     │     │     │     │      │
│──────│─────│─────│─────│─────│──────│
│14:00 │     │▓▓▓▓▓│     │     │      │
│      │     │开庭 │     │     │      │
│      │     │     │     │     │      │
└──────┴─────┴─────┴─────┴─────┴──────┘

操作：长按日程块可拖动调整时间
```

---

### 4.3 通知中心

| 通知类型 | 可操作 |
|----------|--------|
| 任务指派 | 查看详情 |
| 审批请求 | 直接审批 |
| 日程提醒 | 查看日程 |
| 消息 | 回复消息 |

---

### 4.4 审批流程

| 功能 | 描述 |
|------|------|
| 发起申请 | 完整表单 |
| 审批处理 | 通过/拒绝/退回 |
| 审批跟踪 | 查看审批进度 |

---

## 五、P2 模块设计

### 5.1 个人仪表盘

| 数据 | 展示 |
|------|------|
| 今日工时 | 时长 + 趋势 |
| 待办任务 | 数量 + 列表 |
| 今日日程 | 时间线 |
| 未读消息 | 数量 |

### 5.2 全局搜索

| 搜索范围 |
|----------|
| 案件 |
| 任务 |
| 文档 |
| 消息 |
| 联系人 |

### 5.3 AI 助手

| 功能 |
|------|
| 语音问答 |
| 法律咨询 |
| 案件查询 |

---

## 六、数据模型

```dart
// 完整实体模型
class User { id, email, name, role, avatarUrl, permissions }
class Case { id, caseNumber, title, description, status, type, clientId, lawyerIds, ... }
class Task { id, title, description, status, priority, dueDate, caseId, assigneeId, subtasks, labels }
class TimeLog { id, caseId, description, startTime, endTime, duration, billingType, status }
class Document { id, caseId, name, type, url, versions, annotations }
class Event { id, title, startTime, endTime, location, attendees, recurrence }
class Message { id, channelId, senderId, content, type, attachments, createdAt }
class Approval { id, type, status, applicantId, approvers, data, history }
```

---

## 七、与 Web 端功能对比

| 功能 | Web 端 | 移动端 | 备注 |
|------|--------|--------|------|
| 新建案件向导 | ✅ | ✅ | 功能对等 |
| 案件详细编辑 | ✅ | ✅ | 功能对等 |
| 看板高级编辑 | ✅ | ✅ | 触屏适配拖拽 |
| 详细工时编辑 | ✅ | ✅ | 功能对等 |
| 文档编辑/批注 | ✅ | ✅ | 功能对等 |
| 日程批量安排 | ✅ | ✅ | 功能对等 |
| 仪表盘 | ✅ MDI | ✅ 卡片式 | 布局适配 |
| 系统管理 | ✅ | ⚠️ 基础 | 复杂配置仅Web |

---

**文档版本**: v3.0  
**更新说明**: 移动端实现完整功能，与 Web 端对等
