# 模块图 (Module Diagram)

**版本**: V9.0
**描述**: 系统的高层模块与依赖关系图。

```mermaid
graph TB
    subgraph "Frontend (Next.js App Router)"
        User[User (Lawyer/Partner/Client)]
        
        subgraph "Layout Layer"
            RootLayout
            DashboardLayout
            FloatingLayer["Floating Layer (Portals)"]
        end
        
        subgraph "Core Modules"
            AuthModule["Auth (NextAuth v5)"]
            CaseModule["Case Management"]
            DispatchModule["Smart Dispatch"]
            DocModule["Knowledge & Drafting"]
        end
        
        subgraph "Floating Components"
            TimerWidget["Timer (PiP)"]
            ChatWidget["Global Chat"]
            CmdK["Command Palette"]
        end
    end

    subgraph "Backend (Server Actions + Prisma)"
        Actions["Server Actions (RPC)"]
        RBAC["Permission Service"]
        QueueService["Async Task Queue"]
    end

    subgraph "Data Layer"
        Postgres[(PostgreSQL)]
        VectorDB[(pgvector)]
    end

    User --> RootLayout
    DashboardLayout --> FloatingLayer
    FloatingLayer --> TimerWidget
    FloatingLayer --> ChatWidget
    
    CaseModule --> Actions
    DispatchModule --> Actions
    DocModule --> Actions
    
    Actions --> RBAC
    Actions --> Postgres
    Actions --> QueueService
    QueueService --> Postgres
```
