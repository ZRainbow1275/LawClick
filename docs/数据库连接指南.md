# LawClick 数据库连接指南

## 架构概述
LawClick 使用 **PostgreSQL** 作为主数据库，运行在 Docker 容器中。

## 连接信息
- **主机 (Host)**: `127.0.0.1` (或 `localhost`)
- **端口 (Port)**: `5434` (注意：为了避免冲突，映射到了 5434 而非默认的 5432)
- **数据库名 (Database)**: `lawclick`
- **用户名 (User)**: `postgres`
- **密码 (Password)**: `password`
- **Schema**: `public`

## 连接字符串 (Connection String)
在 `.env` 文件或数据库管理工具（如 DBeaver, Navicat）中使用：
```
postgresql://postgres:password@127.0.0.1:5434/lawclick?schema=public
```

## Docker 管理
数据库由 `docker-compose.yml` 管理。

### 启动数据库
```bash
cd lawclick-next
docker compose up -d
```

### 停止数据库
```bash
cd lawclick-next
docker compose down
```

### 查看日志
```bash
docker logs lawclick-postgres
```

## Prisma 操作（主线）
- **应用现有迁移（可复现）**：`pnpm -C lawclick-next exec prisma migrate deploy`
- **创建/演进迁移（仅开发时）**：`pnpm -C lawclick-next exec prisma migrate dev --name <name>`
- **查看数据（GUI）**：`pnpm -C lawclick-next exec prisma studio`
- **数据基线（严禁造数）**：导入脱敏生产快照：`pnpm restore:snapshot -- --file <path-to-dump> --reset --yes`
- **快照规范**：`docs/脱敏生产快照_导入规范.md`
