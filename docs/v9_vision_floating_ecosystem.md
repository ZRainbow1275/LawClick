# LawClick V9.0 架构师愿景：漂浮生态与深度工作 (The Floating Ecosystem & Deep Work)

**文档编号**: LC-VISION-V9.1 (Revised)
**性质**: 核心架构思想记录 (Architectural Manifesto)
**关联实施表**: [v9_task_matrix.md](./v9_task_matrix.md)

---

## 1. 批判性审视与核心矛盾 (Critical Review)

基于对 V8.0 (MVP) 的深度复盘，我们识别出以下阻碍产品成为“卓越”的关键矛盾：

### 1.1 "工具" vs "生态" 的矛盾
*   **现状**: V8.0 是一个优秀的“网页应用”。用户需要打开它，操作它，关闭它。
*   **批判**: 律师的工作是流动的。固定的网页应用是**“做减法”**（打断心流）。
*   **V9.0 愿景**: **漂浮生态 (Floating Ecosystem)**。核心组件（计时、聊天、笔记）必须具备“脱离母体”的能力，利用 Picture-in-Picture 或 Overlay 技术，像空气一样悬浮在律师的所有工作场景之上。

### 1.2 "记录" vs "生产" 的矛盾
*   **现状**: 既然叫“记录仪”，它就只做记录。上传文档、记录工时。
*   **批判**: 记录是**后置**的痛苦，生产是**前置**的价值。如果系统不能帮助律师*写*出更好的文书、*审*出更多的风险，它就永远是律师的负担。
*   **V9.0 愿景**: **深度工作引擎 (Deep Work Engine)**。从“文件柜”进化为“工作台”。支持在线高亮、批注、AI 辅助审查。

### 1.3 "孤岛" vs "复用" 的矛盾 (Knowledge GAP)
*   **现状**: 律师每次写合同都是“从零发明轮子”。AI 聊天机器人是“通用”的，不知道律所过去办过一模一样的案子。
*   **批判**: 律所最大的资产不是桌椅，而是**过往的文书和经验**。现在的系统让这些资产在硬盘里发霉。
*   **V9.0 愿景**: **机构记忆 (Institutional Memory)**。引入 Vector DB (向量数据库)，实现 RAG (检索增强生成)。当你写“不可抗力”条款时，系统自动推送本所最完美的“不可抗力”范本。

### 1.4 "管理" vs "体验" 的矛盾 (Architectural GAP)
*   **现状**: 试图复刻财务软件的账单逻辑（但也没做透），且缺乏异步处理能力。
*   **批判**: 
    *   **架构师批判**: 只有骨架（Next.js），没有血肉（Complex Domain Logic）和神经（Async Queue）。缺乏全文检索，权限控制太幼稚。
    *   **合伙人批判**: 我不需要你算账（我有金蝶/用友），我需要你帮我**管客户体验 (CX)** 和 **派活 (Allocation)**。
*   **V9.0 愿景**: 
    *   **技术完备性**: 引入 Message Queue (异步处理)、Full-Text Search (全文检索)、Granular RBAC (细粒度权限)。
    *   **智能调度**: 基于状态感知的任务分配系统。

---

## 2. 核心架构升级 (Architectural Pillars)

### 2.1 极致的组件化 (Lego Architecture)
*   **定义**: 任何功能单元（Unit）都必须具备独立生存的能力。
*   **技术指标**:
    *   **可拆卸 (Detachable)**: 比如 Chat Panel，既是 Case Detail 页面的右侧栏，也可以被“撕”下来变成一个悬浮窗。
    *   **上下文感知**: 组件知道自己在哪。悬浮时是“全景模式”，嵌入时是“聚焦模式”。

### 2.2 状态感知神经网与智能分配 (Status Network & Smart Dispatch)
*   **痛点**: 协作的本质是“打扰”。且合伙人分派任务时，不知道谁手里有活，谁在摸鱼。
*   **解决方案 A: 自动状态机**:
    *   **Deep Work (红灯)**: 计时器运行中 + 文档编辑中 -> 系统自动拦截非紧急通知。
    *   **Free (绿灯)**: 无计时任务 -> 允许即时通讯。
*   **解决方案 B: 智能分配台 (Smart Dispatch)**:
    *   合伙人看到的不是列表，而是**“负载热力图”**。
    *   分配逻辑：当拖拽一个任务给律师 A 时，系统提示：“A 正在撰写紧急代理词（已专注 3 小时），建议分配给负载较低的 B，或者放入 A 的‘明日队列’”。
    *   **激活效能**: 计时不仅是为了算钱，更是为了**保护律师的时间**不被随意打断。

### 2.3 机构记忆引擎 (Knowledge Engine)
*   **技术栈**: Vector DB (pgvector/Milvus) + LLM。
*   **场景**:
    *   **语义检索**: 搜索“股东纠纷”，不再只匹配标题，而是匹配案情相似度。
    *   **主动推送**: 只要打开 Word 插件，右侧自动浮现相似的历史文书片段。

### 2.4 技术完备性 (Technical Completeness)
*   **后端**: 
    *   **Queue**: 引入 Redis/BullMQ 处理文件 OCR、邮件同步、通知推送。
    *   **Search**: 引入 Elasticsearch 或针对 Postgres 优化 `tsvector`。
*   **权限**: 基于 Policy 的 RBAC 设计 (如 `can(User, 'update', Case, { status: 'DRAFT' })`)。

---

## 3. 下一步行动指引 (Directive)

基于此完善后的愿景，开发工作的优先级调整为：

1.  **Phase 1: Visuals**: 仍然是第一位。没有专业感的界面，再好的内核也没人信。
2.  **Phase 2: Floating & Status**: 实现“状态感知”和“悬浮”基础。
3.  **Phase 3: Smart Dispatch**: 基于状态数据，开发任务分配界面。
4.  **Phase 4: Knowledge Backend**: 搭建向量数据库和异步队列，解决“知识复用”和“技术完备”问题。

（详细执行任务见 [v9_task_matrix.md](./v9_task_matrix.md)）
